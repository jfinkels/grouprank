\documentclass{article}

% Package `amsthm` and `thmtools` must come before package `hyperref`.
\usepackage{amsthm}
\usepackage{thmtools}
% Package `hyperref` must come before package `complexity`.
\usepackage[pdftitle={Restricted probabilistically checkable proofs}, pdfauthor={Jeffrey Finkelstein}]{hyperref}
\usepackage{complexity}
\usepackage{amsmath}
\usepackage{amssymb}

\newcommand{\gen}[1]{{\langle #1 \rangle}}
\newcommand{\email}[1]{\href{mailto:#1}{\nolinkurl{#1}}}

\declaretheorem[]{theorem}
\declaretheorem[numberlike=theorem]{conjecture}
\declaretheorem[numberlike=theorem]{lemma}
\declaretheorem[numberlike=theorem]{proposition}
\declaretheorem[numberlike=theorem, style=definition]{definition}

\title{Complexity of computing minimum generating sets for groups}
\author{Jef{}frey~Finkelstein}
\date{\today}

\begin{document}
\maketitle

\section{Introduction}

In this work we study the problem of computing the size of the minimum generating set of a group when given as a Cayley table, as well as the restriction of this problem to restricted classes of groups.
Previously, the best upper bound for this problem was $\L^2$ (also known as $\DSPACE(\log^2 n)$), due to \cite{lsz77} (also described in \cite[Proposition~3]{at06}).
The more recent work by many authors on ``bounded nondeterminism'' (in which an algorithm is allowed to nondeterministically guess a limited amount of bits and then verify the guess deterministically) as well as improved algorithms for deciding group membership due to \cite{bm89} and \cite{bklm01} allow us to improve this upper bound to $\GC(\log^2 n, \L)$ (defined in \autoref{sec:prelim}) using a more careful analysis of the original $\L^2$ algorithm.

The related problem of deciding group membership was placed in $\L^2$ by \cite{lsz77}, and later improved to \SL{} by \cite{bm89}.
In \cite{bklm01}, the group membership problem for several restricted classes of groups was placed in \FOLL, a class similar to $\AC^0$ but with $O(\log \log n)$ depth.
The more recent proof that $\SL = \L$ \cite{reingold08} places the membership problem for general groups (and thus for restricted classes of groups) squarely in \L.

Also related is the problem of deciding whether two given groups are isomorphic.
A series of works improved the upper bound for the \emph{quasi}group isomorphism problem (and hence the group isomorphism problem) from $\GC(\log^2 n, \P)$ \cite{py96} to $\GC(\log^2 n, \NC^2)$ \cite{wolf94} to $\GC(\log^2 n, \SAC^1)$ \cite{wagner10} to $\GC(\log^2 n, \FOLL)$ \cite{ctw10}.

\section{Preliminaries}\label{sec:prelim}

\P{} is the class of decision problems decidable by a deterministic Turing machine halting in polynomial time.
$\L^2$ is the class of decision problems decidable by a deterministic Turing machine using at most $O(\log^2 n)$ space.
The (inclusion) relationship between \P{} and $\L^2$ is unknown.
\FOLL{} is the class of decision problems decidable by a $\DTIME(\log n)$-uniform family of circuits with polynomial size, unbounded fan-in, and $O(\log \log n)$ depth.
$\FOLL^2$ is the same, but with $O(\log^2 \log n)$.
Following the notation of Cai and Chen \cite{cc97}, $\GC(f(n), \mathcal{C})$ is the class of decision problems decidable by a $\mathcal{C}$ machine augmented with $O(f(n))$ nondeterministic bits.
We will consider specifically the complexity classes $\GC(\log^2 n, \L)$ and $\GC(\log^2 n, \FOLL)$.
%% TODO definitions for many-one and conjunctive truth table reductions

If $(G, \cdot)$ is a group and $S$ is a subset of $G$ then the set of words on $S$ is denoted $S^*$ and the set of inverses of elements in $S$ is denoted $S^{-1}$.
If $T \subseteq G$, the set \emph{generated} by $T$, denoted $\gen{T}$, is the transitive closure of $\cdot$ on $T$.
A \emph{generating set} for $(G, \cdot)$ is a set $T \subseteq G$ such that $\gen{T} = G$.

We will also consider subclasses of the class of all groups: \textsc{Group}, \textsc{Constant Solvability Class}, \textsc{Nilpotent}, \textsc{Abelian}, \textsc{$p$-Group}, \textsc{Elementary Abelian}, \textsc{Cyclic}, where \textsc{Group} is the class of all groups, \textsc{Constant Solvability Class} is the class of all groups of solvability class $O(1)$, etc.

\section{Computing the size of the minimum generating set}

Some applications may require computing the size of the minimum generating set for a given group.
In order to study its complexity, we define a decision problem corresponding to this optimization problem.

\begin{definition}[\textsc{Min Gen Size($\mathcal{G}$)}]
  \mbox{}

  \textbf{Instance:} finite group $(G, \cdot)$ (given as a Cayley table) in the class $\mathcal{G}$, natural number $k$ (given in binary).

  \textbf{Question:} Does there exist a $T \subseteq G$ such that $\gen{T} = G$ and $|T| \leq k$?
\end{definition}

Since each of the other classes of groups is a subclass of \textsc{Group}, an upper bound on the complexity of \textsc{Min Gen Size(Group)} is also an upper bound on the complexity of \textsc{Min Gen Size} for all the other subclasses.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% TODO this doesn't work because according to Wikipedia, a nontrivial finite %
%% group is not a free group.                                                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% We will show that the upper bound for \textsc{Min Gen Size(Group)} is \P.
%% In order to show that the problem is decidable in deterministic polynomial time, we reduce it to the \textsc{Min Rank(Free Group}} problem, which is known to be \P-complete \cite[Problem~A.8.11]{ghr95}.

%% \begin{definition}[\textsc{Min Rank(Free Group)}]
%%   \mbox{}

%%   \textbf{Instance:} finite set $S$, finite set $U \subseteq (S \cup S^{-1})^*$, natural number $k$ (given in binary).

%%   \textbf{Question:} Does there exist a $T \subseteq \gen{U}$ such that $\gen{T} = \gen{U}$ and $|T| \leq k$?
%% \end{definition}

%% \begin{lemma}\label{lem:mingenp}
%%   $\textsc{Min Gen Size(Group)} \in \P$.
%% \end{lemma}
%% \begin{proof}
%%   We show a logarithmic space many-one reduction from \textsc{Min Gen Size(Group)} to \textsc{Min Rank(Free Group)}.
%%   Since \textsc{Min Rank(Free Group)} is in \P{} and \P{} is closed under polynomial time many-one reductions, we conclude that \textsc{Min Rank(Free Group)} is also in \P.
%%   The reduction is the mapping $\langle (G, \cdot), k \rangle \mapsto \langle G, G, k \rangle$.
%%   First, we observe that $\langle G, G, k \rangle$ is a correctly formatted instance of the reduced problem: $G$ is a finite set and $G \subseteq (G \cup G^{-1})^*$.

%%   Suppose that $\langle (G, \cdot), k \rangle \in \textsc{Min Gen Size(Group)}$, so there exists a $T \subseteq G$ such that $\gen{T} = G$ and $|T| \leq k$.
%%   Since $G$ is closed under $\cdot$, we know $\gen{G} = G$ and hence $\gen{T} = \gen{G}$.
%%   Therefore we conclude that $\langle G, G, k \rangle \in \textsc{Min Rank(Free Group)}$.
%%   For the converse, suppose that $\langle G, G, k \rangle \in \textsc{Min Rank(Free Group)}$, so there exists a $T \subseteq \gen{G}$ such that $\gen{T} = \gen{G}$.
%%   As stated above, $\gen{G} = G$, so $\gen{T} = G$.
%%   Therefore $\langle (G, \cdot), k \rangle \in \textsc{Min Gen Size(Group)}$.

%%   We have shown a correct logarithmic space many-one reduction to a problem in \P, and we conclude that $\textsc{Min Gen Size(Group)} \in \P$.
%% \end{proof}

Previously, the \textsc{Min Gen Size(Group)} problem was known to be in $\L^2$, the class of problems decidable by a deterministic Turing machine using at most $O(\log^2 n)$ space \cite{lsz77} (see \cite[Proposition~3]{at06} for a brief description of the algorithm; I can't find a copy of \cite{lsz77} online).
We can improve this upper bound by a more careful analysis of the $\L^2$ algorithm.
We require a definition of the following auxiliary problem.

\begin{definition}[\textsc{Membership($\mathcal{G}$)}]
  \mbox{}

  \textbf{Instance:} finite group $(G, \cdot)$ (given as a Cayley table) in the class $\mathcal{G}$, finite set $S \subset G$, group element $v \in G$.

  \textbf{Question:} Is $v \in \gen{X}$?
\end{definition}

\begin{lemma}\label{lem:membershipinl}
  $\textsc{Membership(Group)} \in \L$.
\end{lemma}
\begin{proof}
  Since $\textsc{Membership(Group)} \in \SL$ \cite[Section~3]{bm89}, and $\SL = \L$ \cite{reingold08}, the lemma follows.
\end{proof}

Upper bounds on the complexity of \textsc{Membership($\mathcal{G}$)} for several subclasses of \textsc{Group} are explored in \cite{bklm01}.
%We use the logarithmic space algorithm for this problem to give a simple $\GC(\log^2 n, \L)$ algorithm for \textsc{Min Group Gen}.

Before providing the general algorithm for computing the size of the minimum generating set for classes of groups, we require one algebraic lemma which bounds the size of the minimum generating set of any finite group.

\begin{lemma}\label{lem:log}
  If $(G, \cdot)$ is a finite group then the size of the minimum generating set is at most $\log n$.
\end{lemma}
\begin{proof}
  Proof can be found at \url{http://math.stackexchange.com/a/226938/29369}, add it here.
\end{proof}

\begin{theorem}\label{thm:mingengc}
  $\textsc{Min Gen Size(Group)} \in \GC(\log^2 n, \L)$.
\end{theorem}
\begin{proof}
  The algorithm proceeds as follows on input $\langle (G, \cdot), k \rangle$, where $G$ is a group of order $n$ with distinguished identity element $e$:
  \begin{itemize}
  \item Nondeterministically guess a subset $S \subseteq G$ of cardinality at most $k$.
  \item Accept if and only if for all $v \in G$, $\langle G, S, v \rangle \in \textsc{Membership(Group)}$.
  \end{itemize}

  First we prove that this algorithm uses $O(\log^2 n)$ nondeterministic bits and $O(\log n)$ space.
  The size of each group element, represented as number in binary, is $\log n$.
  By \autoref{lem:log}, we assume without loss of generality that the size of the minimum generating set for a group of order $n$ is at most $\log n$, so $k$ must be at most $\log n$.
  Therefore the total number of nondeterministic bits required to guess $S$ is $O(\log^2 n)$.
  Iterating over all elements of $G$ requires $O(\log n)$ space to keep track of the current element in the iteration.
  Since $\textsc{Membership(Group)} \in \L$ by \autoref{lem:membershipinl}, deciding whether $\langle G, S, v \rangle \in \textsc{Membership(Group)}$ uses at most $O(\log n)$ space.
  Therefore the total space required for this algorithm (other than the read-only input and read-only nondeterministic bits) is $O(\log n)$.

  Next we show that the algorithm correctly decides the problem.
  Suppose $\langle (G, \cdot), k) \rangle \in \textsc{Min Gen Size(Group)}$, so there exists a $T \subseteq G$ such that $|T| \leq k$ and $\gen{T} = G$.
  One of the sets $S$ of cardinality at most $k$ that the algorithm guesses will equal $T$, since $|T| \leq k$.
  For all elements $v \in G$, we have $v \in \gen{T}$ since $\gen{T} = G$.
  Hence the (correct) algorithm for \textsc{Membership(Group)} will accept for all $v \in G$, and the overall algorithm will accept.
  For the converse, suppose the algorithm accepts the input $\langle (G, \cdot), k \rangle$.
  This occurs exactly when it has guessed a set $S$ of cardinality at most $k$ such that all elements $v$ in $G$ are members of the subgroup generated by $S$.
  Thus $S$ is a generating set for $G$ of cardinality at most $k$, so $\langle (G, \cdot), k \in \textsc{Min Gen Size(Group)}$.
\end{proof}

This improves the previous upper bound, $\L^2$, because
\begin{equation*}
  \GC(\log^2 n, \L) \subseteq \GC(\log^2 n, \NC^2) \subseteq \L^2,
\end{equation*}
where the first inclusion follows from the fact that $\L \subseteq \NL \subseteq \NC^2$, and the second is proven in \cite[Lemma~3.2.8]{wolf90}.

%% From \autoref{lem:mingenp} and \autoref{lem:mingengc}, we immediately get the following theorem.

%% \begin{theorem}
%%   $\textsc{Min Group Gen} \in \GC(\log^2 n, \L) \cap \P$.
%% \end{theorem}

We conjecture that this is not the best possible upper bound, and more clever algebra may reveal a more efficient algorithm.

%% \begin{conjecture}
%%   $\textsc{Min Gen Size(Group)} \in \L$.
%% \end{conjecture}

\begin{theorem}
  \mbox{}
  \begin{enumerate}
  \item Each of the problems
    \begin{itemize}
    \item \textsc{Min Gen Size(Cyclic)},
    \item \textsc{Min Gen Size(Elementary Abelian)},
    \item \textsc{Min Gen Size(Abelian)}, and
    \item \textsc{Min Gen Size(Constant Solvability Class)}
    \end{itemize}
    is in $\GC(\log^2 n, \FOLL)$.
  \item $\textsc{Min Gen Size(Nilpotent)} \in \GC(\log^2 n, \FOLL^2)$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  \mbox{}
  \begin{enumerate}
  \item
    We know that the membership problem for each of these classes of groups is in \FOLL{} by \cite[Section~3]{bklm01}.
    A slight modification of the algorithm from \autoref{thm:mingengc} can be used to show that each of these problems is in $\GC(\log^2 n, \FOLL)$.
    After nondeterministically guessing a set $S$, instead of iterating over each element of the group in logarithmic space, we use $n$ instances of the \FOLL{} circuit which decides the membership problem and compute the conjunction of the output of each of the instances for one additional layer of depth and a $O(n)$ increase in the size of the circuit.
    Since the size of the circuit remains polynomial in $n$ and the depth remains $O(\log \log n)$, we have shown $\textsc{Min Gen Size(Cyclic)} \in \GC(\log^2 n, \FOLL)$.
  \item The same argument applies, except using the fact that the membership problem for nilpotent groups is in $\FOLL^2$ \cite[Corollary~3.12]{bklm01}. \qedhere
  \end{enumerate}
\end{proof}
%% Observe that even though, for example, $\textsc{Membership(Cyclic)} \in \L \cap \FOLL$, we show that \textsc{Min Gen Size(Cyclic)} is in
%% \begin{equation*}
%%   \GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL)
%% \end{equation*}
%% instead of
%% \begin{equation*}
%%   \GC(\log^2 n, \L \cap \FOLL),
%% \end{equation*}
%% for syntactic reasons (the second step in the algorithm from \autoref{thm:mingengc} is either a logarithmic space Turing machine procedure or a $\FO(\log \log n)$ procedure, but not both simultaneously).

At this point, we provide a clearer presentation of the proof of \cite[Theorem~7]{at06}.

\begin{proposition}
  $\textsc{Min Gen Size(Nilpotent)} \leq_{ctt}^P \textsc{Min Gen Size(p-Group)}$.
\end{proposition}
\begin{proof}
  Define the reduction by
  \begin{equation*}
    \langle G, k \rangle \mapsto \bigwedge_{i=1}^m \langle S_{p_i}, k \rangle
  \end{equation*}
  for all nilpotent groups $G$ of order $n$ and all postive integers $k$, where the prime factorization of $n$ is $p_1^{e_1}p_2^{e_2}\dotsb p_m^{e_m}$ and $S_{p_i}$ is the unique $p_i$-Sylow subgroup of $G$.
  Since the length of the input is $n^2$, the prime factorization of $n$ can be computed in polynomial time with respect to the length of the input.
  For each $i$, the Cayley table of the $p_i$-Sylow subgroup of $G$ can be computed in polynomial time because \ldots.
  The number of clauses in the conjunction is $m$, which is the number of prime factors of $n$, which is bounded by a polynomial in $n^2$ because \ldots.
  Hence the reduction is polynomial time computable.

  Suppose $\langle G, k \rangle \in \textsc{Min Gen Size(Nilpotent)}$.
  \ldots
\end{proof}

\begin{proposition}
  $\textsc{Min Gen Size(p-Group)} \leq_m^P \textsc{Min Gen Size(Elementary Abelian)}$.
\end{proposition}
\begin{proof}
  Define the reduction by
  \begin{equation*}
    \langle G, k \rangle \mapsto \left\langle \frac{G}{\Phi(G)}, k \right\rangle
  \end{equation*}
  for all $p$-groups $G$ of order $n$ and all positive integers $k$, where $\Phi(G)$ is the Frattini subgroup of $G$.
  By \autoref{lem:frattinip}, the Cayley table of $\Phi(G)$ is computable in polynomial time.
  By \autoref{lem:factorgroup}, the Cayley table of $\frac{G}{\Phi(G)}$ is computable in polynomial time.
  Hence the reduction is polynomial time computable.

  \ldots
\end{proof}

\begin{lemma}
  $\textsc{Min Gen Size(Elementary Abelian)} \in \P$.
\end{lemma}
\begin{proof}
  Every elementary abelian group is isomorphic to $(\frac{\mathbb{Z}}{p\mathbb{Z}})^m$ where $p$ is a prime number and $m$ is a non-negative integer.
  The minimum generating set for $\frac{\mathbb{Z}}{p\mathbb{Z}}$ is $\{1\}$, so the minimum generating set for $(\frac{\mathbb{Z}}{p\mathbb{Z}})^m$ is
  \[
  \{(1, 0, \dotsc, 0), (0, 1, 0, \dotsc, 0), \dotsc, (0, \dotsc, 0, 1)\}.
  \]
  Therefore the size of the minimum generating set for every elementary abelian group is $m$.

  On input $\langle (G, \cdot), k \rangle$, the polynomial time algorithm computes $m$, then compares that with $k$.
  TODO how long does it take to compute $m$ \ldots
\end{proof}

\begin{theorem}
  $\textsc{Min Gen Size(Nilpotent)} \in \P$.
\end{theorem}
\begin{proof}
  Since a many-one reduction implies a conjunctive truth table reduction, we have
  \begin{equation*}
    \textsc{Min Gen Size(Nilpotent)} \leq_{ctt}^P \textsc{Min Gen Size(p-Group)},
  \end{equation*}
  and
  \begin{equation*}
    \textsc{Min Gen Size(p-Group)} \leq_{ctt}^P \textsc{Min Gen Size(Elementary Abelian)}.
  \end{equation*}
  Since polynomial time conjunctive truth table reductions compose this implies
  \begin{equation*}
    \textsc{Min Gen Size(Nilpotent)} \leq_{ctt}^P \textsc{Min Gen Size(Elementary Abelian)}.
  \end{equation*}
  Since $\textsc{Min Gen Size(Elementary Abelian)} \in \P$ and $\P$ is closed under polynomial time conjunctive truth table reductions, $\textsc{Min Gen Size(Nilpotent)} \in \P$.
\end{proof}

\autoref{fig:results} contains a summary of the results found in this work.

%% TODO ensure that this is correct
\begin{figure}
\caption{A summary of the improved upper bounds due to this work for the problem of computing the size of the minimum generating set of a class of groups.\label{fig:results}}
  \begin{center}
    \begin{tabular}{l | l}
      \multicolumn{1}{c |}{Subclass of \textsc{Group}}
      &
      \multicolumn{1}{| c}{Upper bound for \textsc{Min Gen Size}} \\
      \hline
      \hline
      \textsc{Group} & $\GC(\log^2 n, \L)$ \\
      \textsc{Solvable} & $\GC(\log^2 n, \L)$ \\
      \textsc{Nilpotent} & $\GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL^2) \cap \P$ \\
      \textsc{p-Group} & $\GC(\log^2 n, \L) \cap \P$ \\
      \textsc{Constant Solvability Class} & $\GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL)$ \\
      \textsc{Abelian} & $\GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL)$ \\
      \textsc{Elementary Abelian} & $\GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL) \cap \P$ \\
      \textsc{Cyclic} & $\GC(\log^2 n, \L) \cap \GC(\log^2 n, \FOLL) \cap \P$
    \end{tabular}
  \end{center}
\end{figure}

\section{Future work}

As noted in the introduction, the (quasi)group isomorphism problem is known to be in $\GC(\log^2 n, \FOLL)$.
What is the relationship between this problem and the minimum generating set size problem for groups?

What is the relationship between computing the size of the minimum generating set and computing the minimum generating set itself?

\section{About this work}

Copyright 2012 Jef{}frey Finkelstein.

This work is licensed under the Creative Commons Attribution-ShareAlike License 3.0.
Visit \mbox{\url{https://creativecommons.org/licenses/by-sa/3.0/}} to view a copy of this license.

The \LaTeX{} markup which generated this document is available on the World Wide Web at \mbox{\url{https://github.com/jfinkels/ncapproximation}}.
It is also licensed under the Creative Commons Attribution-ShareAlike License.

The author can be contacted via email at \email{jeffreyf@bu.edu}.

\bibliographystyle{plain}
\bibliography{references}

\end{document}
